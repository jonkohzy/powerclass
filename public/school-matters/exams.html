<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<link rel="stylesheet" href="../stylesheets/common.css" type="text/css">
	<link rel="stylesheet" href="../stylesheets/nav.css" type="text/css">
	<link rel="stylesheet" href="../stylesheets/school-matters.css" type="text/css">
	<link rel="stylesheet" href="dropdown.css" type="text/css">
	<title>PowerClass | Exam Results</title>
	<style>
		.heading {
			margin-bottom: 0;
		}
		button{
			width: calc(30% - 10px);
			position: relative;
			display: block;
			margin-left: calc(70% + 10px);
			font-family: inherit;
			background: transparent;
			color: #fc5185;
			font-size: 14px;
			text-decoration: none;
			border: 2px solid #fc5185;
			padding: 10px;
			text-transform: uppercase;
			overflow: hidden;
			transition: 0.3s all ease;
			z-index: 2;
		}
		button:hover {
			background-color: #fc5185;
			color: white;
		}
		.exams, .reports {
			float: left;
			width: calc(50% - 64px);
			height: 100%;
			padding-right: 30px;
		}
		.exams {
			border-right: 1px solid black;
			margin-right: 32px;
		}
	</style>
</head>
<body>
    <div class="header">
		<a href = "../dashboard.html" class="name">PowerClass</a>
		<a href="../outstanding-work.html" class="header-item outstanding-work-navlink">Outstanding Work</a>
		<a class="header-item school-matters-navlink">School Matters&nbsp;&nbsp;
			<span class="disclosure-triangle">&#9660;</span>
		</a>
		<a href="../message-board.html" class="header-item message-board-navlink">Message Board</a>

		<div class="user">
			<img class="icon" src="../img/user.png" alt="profile picture" onclick="show_profile();">
		</div>
	</div>
	<!--header end-->
	<!--navbar-->
	<div class="navi">
		<a href="announcements.html">Announcements</a>
		<a href="cip.html">CIP</a>
		<a href="discipline.html">Discipline</a>
		<a href="events.html">Events</a>
		<a class="selected" href="exams.html">Exams</a>
		<a href="particulars.html">Particulars</a>
		<a href="project-work.html">Project Work</a>
	</div>
	<div class = "content">
		<div class="exams">
			<h1 class = "heading">Exams</h1>
			<div class = "select">
				<input class="chosen-value" type="text" value="" placeholder="Loading...">
				<ul style = "padding-left: 0px" class = "value-list"></ul>
				<button onclick="show()">Check your results</button>
			</div>

		<table style = "margin-top: 50px" cellspacing = "10">

		</table>
		</div>

		<div>
			<h1 class = "heading">Reports</h1>
		</div>
	</div>
	<!-- weird fix for transitions firing on page load -->
	<script>
		let Results;
		let Reports;
		fetch("/api/isp/exams", {
			method: "POST",
			headers: { "Content-Type": "application/json" },
			body: JSON.stringify({
				user: "171255n",
				pass: "@cptaHadk0"
			}),
		}).then((res) => res.json()).then(({examResults, reports }) => {
			console.log(examResults);
			Results = examResults
			Reports = reports;
			const SELECT = document.getElementsByClassName("value-list")[0];
			examResults.forEach(results => {
				const OPTION = document.createElement("li");
				OPTION.textContent = results.exam;
				SELECT.appendChild(OPTION);
			});
			drop();
		});
		const show = () => {
			const inputField = document.getElementsByClassName("chosen-value")[0];
			Results.forEach((element) =>{
				if(inputField.value === element.exam){
					const TABLE = document.getElementsByTagName("table")[0];
					while(TABLE.firstChild){
						TABLE.removeChild(TABLE.firstChild);
					}
					element.results.forEach((elem) => {
						const ROW = document.createElement("tr");
						const SUBJECT = document.createElement("td");
						SUBJECT.textContent = elem.subject;
						const MARK = document.createElement("td");
						MARK.textContent = elem.mark;
						ROW.appendChild(SUBJECT);
						ROW.appendChild(MARK);
						TABLE.appendChild(ROW);
					});
				}
			});
		}
	</script>
	<script src = "dropdown.js"></script>
</body>
</html>