<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<link rel="stylesheet" href="../stylesheets/common.css" type="text/css">
	<link rel="stylesheet" href="../stylesheets/nav.css" type="text/css">
	<link rel="stylesheet" href="../stylesheets/school-matters.css" type="text/css">
	<title>Project Work</title>
</head>
<body>
    <div class="header">
		<a href = "../dashboard.html" class="name">PowerClass</a>
		<a href="../outstanding-work.html" class="header-item outstanding-work-navlink">Outstanding Work</a>
		<a class="header-item school-matters-navlink">School Matters</a>
		<a href="../message-board.html" class="header-item message-board-navlink">Message Board</a>

		<div class="user">
			<img class="icon" src="../img/user.png" alt="profile picture" onclick="show_profile();">
		</div>
	</div>
	<!--header end-->

	<!--navbar-->
	<div class="navi">
		<a href="announcements.html">Announcements</a>
		<a href="cip.html">CIP</a>
		<a href="discipline.html">Discipline</a>
		<a href="events.html">Events</a>
		<a href="exams.html">Exams</a>
		<a href="particulars.html">Particulars</a>
		<a class="selected" href="project-work.html">Project Work</a>
	</div>
	<!--navbar end-->

	<div class="content">
		<h1 id="project-name">Loading project...</h1>
		<div id="project-category">Category: </div>
		<div id="project-mentor">Mentor: </div>
		<div id="mentor-approval-wrapper">
			<span id="mentor-approval">Mentor approval status: </span>
			<img id="mentor-approval-icon" class="icon">
		</div>
		<div id="category-manager-approval-wrapper">
			<span id="category-manager-approval">Category manager approval status: </span>
			<img id="cat-manager-approval-icon" class="icon">
		</div>
		<div id="project-status-wrapper">
			<span id="project-status">Project status: </span>
			<img id="project-status-icon" class="icon">
		</div>
	</div>

	<script>
		fetch("/api/isp/project-work", {
    	method: "POST",
    	headers: { "Content-Type": "application/json" },
    	body: JSON.stringify({
				user: "171255n",
				pass: "@cptaHadk0",
    	}),
		})
		.then((res) => /* implement error handling before json() */ res.json())
		.then(({
			name,
			category,
			mentor,
			mentorApprovalStatus,
			catManagerApprovalStatus,
			projectStatus
		}) => {
			// add project details
			document.getElementById("project-name").textContent = `Project name: ${name}`;
			document.getElementById("project-category").textContent += category;
			document.getElementById("project-mentor").textContent += mentor;
			document.getElementById("mentor-approval").textContent
					+= mentorApprovalStatus;
			document.getElementById("category-manager-approval").textContent
					+= catManagerApprovalStatus;
			document.getElementById("project-status").textContent += projectStatus;

			// show approval icons
			const mentorApprovalIcon = document.getElementById("mentor-approval-icon");
			if (mentorApprovalStatus === "Approved") {
				mentorApprovalIcon.src = "../img/tick.svg";
			} else {
				mentorApprovalIcon.src = "../img/cross.svg";
			}

			const catManagerApprovalIcon = document.getElementById("cat-manager-approval-icon");
			if (catManagerApprovalStatus === "Approved"
				|| catManagerApprovalStatus === "Not required") {
				catManagerApprovalIcon.src = "../img/tick.svg";
			} else {
				catManagerApprovalIcon.src = "../img/cross.svg";
			}

			const projectStatusIcon = document.getElementById("project-status-icon");
			if (projectStatus === "Approved") {
				projectStatusIcon.src = "../img/tick.svg";
			} else {
				projectStatusIcon.src = "../img/cross.svg";
			}
		});
	</script>
</body>
</html>